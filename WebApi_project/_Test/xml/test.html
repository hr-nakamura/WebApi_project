<html>
<head>
	<meta charset="shift_JIS" />
	<script src="../../_home/_Content/_Scripts/jquery-1.12.4.js" type="text/javascript"></script>
	<script src="../../_home/_Content/_Scripts/jquery.kansa.Query.js" type="text/javascript"></script>
	<title></title>
	<SCRIPT Language="JavaScript">
		window.onload = function () {
            try {


                var Tab = { "V‹K": [], "Šù‘¶": [] };
                var xTab = { "V‹K": "ABC", "Šù‘¶": "XYZ", "V‹K2": "XYZ2", "Šù‘¶2": "XYZ2"};
                var keyList = Object.keys(xTab)
                for (let i in keyList) {
                    if (keyList[i].indexOf("V‹K")) {
                        Tab["V‹K"].push(xTab[keyList[i]]);
                    }
                    else {
                        Tab["Šù‘¶"].push(xTab[keyList[i]]);
                    }
                }


                var xmlFile = "xsl/”„ã—\ŽÀ_V‹K.xml";
				var xslFile = "”„ã—\ŽÀ.xsl";


				var xmlDoc = $.loadXMLDoc(xmlFile);
				var xslDoc = $.loadXMLDoc(xslFile);

				var Buff = $.transformNode(xmlDoc, xslDoc);

				$("body").html(Buff);

			} catch (e) {
				alert(e.message);
			}
		}

        function loadXMLDoc() {
            // ‡@@$.loadXMLDoc("/aaa/bbb/abc.asp?p1=1&p2=2&p3=3");
            // ‡A@$.loadXMLDoc("/aaa/bbb/abc.asp","p1=1&p2=2&p3=3");
            // ‡B@$.loadXMLDoc(url,para1,para2,para3,.......);
            var asyncMode = false;
            var doneProc = null;
            var Buff = {};
            var xmlDoc = null;
            alert("loadXMLDoc");
            try {
                var nvc = new $.NameValueCollection();

                // URL@‚Éƒpƒ‰ƒ[ƒ^‚ª‚Â‚¢‚Ä‚¢‚éê‡‡@
                var Work = arguments[0].split("?");
                Buff["Url"] = Work[0];
                //$.debug(Buff["Url"] ,"loadXMLDoc start");
                if (Work.length > 1) {
                    nvc.Add(Work[1]);
                }
                if (arguments.length > 1 && (typeof (arguments[1]) == "function")) {
                    asyncMode = true;
                    doneProc = arguments[1];
                    arguments = Array.prototype.slice.call(arguments, 1);
                }
                //ƒpƒ‰ƒ[ƒ^‚ð•Ê‚ÉŽw’è‚µ‚½ê‡‡A‡B
                if (arguments.length > 1) {
                    for (var i = 1; i < arguments.length; i++) {
                        if (typeof (arguments[i]) == "string") {
                            nvc.Add(arguments[i]);
                        }
                    }
                }
                Buff["Arg"] = nvc.ToEncodeString();
                var returnValue = "";

                if ((window.ActiveXObject || "ActiveXObject" in window) && Buff["Url"].match(/.+\.(xslt|xsl)$/i)) {
                    //$.debug("IE and xsl", Buff["Url"]);
                    alert("X");
                    var xslDoc = new ActiveXObject("Microsoft.XMLDom");
                    xslDoc.async = false;
                    xslDoc.load(Buff["Url"]);
                    return (xslDoc);
                }
                else {
                    //$.debug("Not IE", Buff["Url"]);
                    $.ajax({
                        url: Buff["Url"],
                        type: "GET",
                        data: Buff["Arg"],
                        contentType: "text/plain",
                        cache: false,
                        async: asyncMode
                    }).done(function (data, status, xhr) {
                        if (asyncMode == true) {
                            //$.debug(Buff["Url"],"async done");
                            xmlDoc = $.str2xml(xhr.responseText);
                            doneProc(xmlDoc);
                        }
                        else {
                            //$.debug(Buff["Url"],"sync done");
                            returnValue = xhr.responseText;
                        }
                    }).fail(function (xhr, status, error) {
                        //$.debug("error");
                        throw new Error(xhr.statusText);
                    }).always(function () {
                        //$.debug(Buff["Url"],"always");
                    });
                    //$.debug(Buff["Url"],"end");
                    xmlDoc = $.str2xml(returnValue);
                    return (xmlDoc);
                }
            } catch (e) {
                $.alert("[loadXMLDoc]", e.message, Buff["Url"]);
                return (null);
            }
        }

	</SCRIPT>
</head>

<body>
</body>
</html>
