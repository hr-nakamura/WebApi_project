<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="/WebApi/project/Scripts/jquery-3.4.1.min.js" type="text/javascript"></script>
    <script src="/WebApi/project/_home/Scripts/jquery.Cookie.js" type="text/javascript"></script>
    <script src="/WebApi/project/_home/Scripts/json2.js" type="text/javascript"></script>
    <script src="/WebApi/project/_home/Scripts/jquery.kansa.Query.js" type="text/javascript"></script>
    <script src="/WebApi/project/_home/debug/jquery.my.debug.js" type="text/javascript"></script>

    <script type="text/javascript">
        var WebApi_url = "/WebApi/project/api/values";
        var WebApi_url_json = "/WebApi/project/api/json";
        var para = {
            visitBBS: "2021/07/01 10:00:00",
            limitYear : 2019
        }
        window.onload = function () {
            var a = 1;
            if ( typeof($.cookie("visitBBS")) == "undefined" ) {
                $.cookie("visitBBS","2021/07/01 10:00:00");
                para.visitBBS = $.cookie("visitBBS");
            }
            para.visitBBS = $.cookie("visitBBS");

            var o_json = call_ajax_api("GET", WebApi_url_json, "QOSMIO/projectTest", para);
            if ($.isJSON(o_json)) {
                var work = JSON.stringify(o_json, null, 2);
                $.alert("結果【JSON】", work);
            }
            else {
                $.alert(o_json);
            }
            var a = 1;
        }
        $(function () {
            //HTMLを初期化
            $("table.tbl tbody").html("");

            //HTMLを生成
            $.getJSON("data.json", function (data) {
                var work = JSON.stringify(data, null, 2);
                var x = $.isJSON(work);
                $(".abc").html(work);
                var a = 1;
            })
        });
    </script>
    <script type="text/javascript">
        function call_ajax_api(mode, url, item, json, callback) {
            //$.alert("call_ajax_mode[" + mode + "]", url);
            window.status = "call_ajax_api[" + mode + "]";
            var options = {
                Item: item,
                Json: JSON.stringify(json)
            };
            var result = $.ajax({
                url: url,
                type: mode,
                data: options,
                dataType: 'text',
                dataFilter: function (data, type) {
                    data = data.replace(/\\/g, "").replace(/\"$/, "").replace(/^\"/, "");
                    return (data);
                },
                //contentType: "application/json",
                //contentType: "application/xml",
                //contentType: "text/plain",
                async: false
            }).done(function (data, status, xhr) {
                returnValue = data;
                //$.alert(returnValue);
            }).fail(function (xhr, status, error) {
                returnValue = status;
                window.status = xhr.statusText;
                $.alert("call_ajax_api error:" + xhr.statusText);
            });
            return (returnValue);
        }
        function call_ajax_api_json(mode, url, item, json, callback) {
            //$.alert("call_ajax_api_json[" + mode + "]", url);
            window.status = "call_ajax_api_json[" + mode + "]";
            var options = {
                Item: item,
                Json: JSON.stringify(json)
            };
            var result = $.ajax({
                url: url,
                type: mode,
                data: options,
                dataType: 'json',
                dataFilter: function (data, type) {
                    return (data);
                },
                //contentType: "application/json",
                //contentType: "application/xml",
                //contentType: "text/plain",
                async: false
            }).done(function (data, status, xhr) {
                returnValue = data;
            }).fail(function (xhr, status, error) {
                returnValue = status;
                window.status = xhr.statusText;
                $.alert("call_ajax_api_json error:" + xhr.statusText);
            });
            return (returnValue);
        }
        function call_ajax_get(url, options) {

            // 受信側でidを指定したときは設定しないとエラーとなる
            // 漢字は渡せない
            //url += "?name5=漢字&Mssage=ABCDEF";
            // ajax:dataで渡したらモデュールでも受信できるが引数指定でも受信できる
            // 漢字も OK
            // Get では「data」を替えると複数のパラメータで呼べる

            $.debug("call_ajax_get", url);
            window.status = "call_ajax_get";
            var result = $.ajax({
                url: url,
                type: "GET",
                data: options,
                dataType: 'text',
                dataFilter: function (data, type) {
                    return (data);
                },
                //contentType: "application/xml",
                //contentType: "text/plain",
                async: false
            }).done(function (data, status, xhr) {
                returnValue = data.replace(/\"$/, "").replace(/^\"/, "");
                //$.alert(returnValue);
            }).fail(function (xhr, status, error) {
                returnValue = status;
                //$.alert("error:" + xhr.statusText);
                window.status = "error:" + xhr.statusText;
            });
            return (returnValue);
        }
    </script>

    <style type="text/css">
        .abc {
            width: 100%;
            height: 300px;
        }
    </style>
</head>
<body>
    <textarea class="abc"></textarea>
</body>
</html>