<!DOCTYPE html>
<html>
<head>
    <meta charset="shift_jis" />
    <title></title>
    <script src="../_Content/_Scripts/jquery-1.9.1.min.js" type="text/javascript"></script>
    <script src="../_Content/_Scripts/jquery.my.webapi.js" type="text/javascript"></script>
    <script src="../_Content/_Scripts/jquery.kansa.Query.js" type="text/javascript"></script>
    <script src="../_Content/_Scripts/DocumentWindow.js" type="text/javascript"></script>
    <script src="../_Content/_Scripts/json2.js" type="text/javascript"></script>
    <script src="../_Content/_debug/jquery.my.debug.js" type="text/javascript"></script>

    <link rel="stylesheet" type="text/css" href="account.css" />

    <title></title>
    <script type="text/javascript">
        var winObj;
        window.onload = function () {
            try {
                $.debug("onload Start", decodeURI(location.href));
                test();

                Object.defineProperty(window, "inputValue", {
                    set(v) {
                        $(winObj.document.body).html(v);
                        $.debug("v");
                    }
                });

            } catch (e) {
                $.alert("onload", e.message);
            }
        }
        window.onunload = function () {
            $.debug("onunload", location.href);
            if (winObj != null && !winObj.closed) winObj.close();
        }
    </script>

    <script type="text/javascript">
        function test() {
            var url = location.href;

            var json = {
                year: 2022,
                //actual: 5
            };
            //$.debug.json("para", json);
            xmlDoc = $.WebApi("売上予測/売上予実_部門", json);
            var xslDoc = $.loadXMLDoc("xsl/売上予実.xsl");

            var Buff = $.transformNode(xmlDoc, xslDoc);
            $(".dataG").html(Buff);

        }
    </script>
    <script type="text/javascript">
        $(function () {
            $(document).on("click", ".onKind", function (event) {
//                alert(this.getAttribute("kind"));
                var gName = this.getAttribute("kind");
                var json = { gName: gName, yymm: 202110, dispCnt: 12, fix: 70 };

                var xmlDoc = $.WebApi("売上予測/グループ予実_部門", json);
                var xslDoc = $.loadXMLDoc("xsl/グループ予実.xsl");

                var Buff = $.transformNode(xmlDoc, xslDoc);


//                "about:blank"
                if (!(winObj && !winObj.closed)) {
                    winObj = window.open("test.html", "uriageWin", "width=800,height=700,scrollbars,resizable,status=no");
//                    winObj.onload = () => window.inputValue = Buff;
                    winObj.onload = () => winObj.postMessage(Buff, window.location.origin);
                }
                else {
                    winObj.postMessage(Buff, window.location.origin);
                    //window.inputValue = Buff;
                }



            });

            $(document).on("mouseenter mouseleave", ".onKind", function (event) {
                if (event.type == "mouseenter") {
                    $(this).css("background-color", "pink");
                    $(this).css("cursor", "pointer");
                } else if (event.type == "mouseleave") {
                    $(this).css("background-color", "");
                    $(this).css("cursor", "");
                }
            });
            $(".test").on("click", function (event) {
                window.inputValue = "ABCDEF";
            });
        });

    </script>
    <script type="text/javascript">
        var newWin = null;
        function winOpen(gName, yymm, dispCnt, actualCnt) {
            var aspName = "グループ予実_部門.asp"
            var para
            para = "?gName=" + gName
            para += "&yymm=" + yymm
            para += "&dispCnt=" + dispCnt
            para += "&actualCnt=" + actualCnt
            para += "&fix=" + fixLevel
            newWin = window.open(aspName + para, "uriageWin", "width=800,height=700,scrollbars,resizable,status=no");
        }

        function winClose() {
            if (newWin != null && !newWin.closed) newWin.close();
        }
    </script>
</head>
<body>
    <button class="test">ABCD</button>
    <table align="center">
        <tbody>
            <TR>
                <TD align="center">
                    <DIV align="center" class="dataG"></DIV>
                </TD>
            </TR>
        </tbody>
    </table>
</body>
</html>
